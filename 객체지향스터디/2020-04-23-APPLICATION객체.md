<tr><td valign="center"><font color="#cc00ff">▣&nbsp;<font size="4"><strong>Application 객체</strong></font></font></td></tr><br style="color: rgb(0, 0, 0); font-family: Gulim; line-height: 19px; "><br style="color: rgb(0, 0, 0); font-family: Gulim; line-height: 19px; "><tr bgcolor="#ffffff"><td valign="center" width="80" height="39"><br /><div align="center"><strong><font color="#ff3366">§ 학습목표</font></strong></div></td><td valign="center"><strong>&nbsp;&nbsp;1. Application 객체의 기능을 간단히 설명할 수 있다.&nbsp;<br />&nbsp;&nbsp;2. Application 객체의 속성과 메소드를 알고 사용할 수 있다.</strong></td></tr><br style="color: rgb(0, 0, 0); font-family: Gulim; line-height: 19px; "><table height="25" cellspacing="0" cellpadding="0" width="100%" border="0" style="color: rgb(0, 0, 0); font-family: Gulim; font-size: 12px; line-height: 19px; "><tbody><tr><td valign="top"><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; "><br /></p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><strong><font size="3">1. Application 객체</font></strong></p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">Application 객체는 웹애플리케이션 실행시 사용중인 모든 사용자들이 접근할 수 있는 정보를 다루는데 사용된다. 클라이언트가 asp문서를 요구하게 하게 되면 웹서버는 해당하는 asp문서를 처리하기 위해 ASP.DLL 파일을 로드하여 수행한 결과를 클라이언트에게 전송한다는 것을 이미 설명한 적이 있다. 이때 ASP.DLL 이 실행되면 웹서버상에 있는 모든 ASP코드를 실행할 수 있는 상태가 되는데 이 시점이 Application 객체가 시작된 시점이라고 말할 수 있다. 이때 다른 클라이언트가 asp문서를 요구해도 Application 객체는 다시 시작 하지는 않는다. 즉 한번만 살행되면 모든 사람이 같이 이용하는 것이다.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">Application 객체가 졸료되는 시점은 웹서버에 접속되어 있는 모든 사용자가 연결을 끊은 후 일정 시간이 지나면 자동으로 종료된다.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><br /></p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><br /></p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">위의 그림은 웹서버가 처음으로 준비되면 일단은 애플리케이션 객체는 중지된 상태이다. 이때 처음으로 클라이언트A가 접속하면 Application 객체가 시작하고 나중에 배우겠지만 클라이언트 A에 대한 Session 객체가 생성되어 시작된다.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">클라인트 B접속할때에는 이미 Application 객체가 시작되고 있는 상태이기 때문에 클라이언트 B에 대한 Session 객체만 생성이 된다.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">클라이언트 A가 연결을 종료하더라도 클라이언트 B가 서버에 접속되어 있기 때문에 Application 객체는 계속 유지되고 Session 객체만 종료된다.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">클라이언트 B가 연결을 종료하면 Session 객체가 종료한다. 이때 웹서버에 접속해 있는 사용자가 한명도 없을 경우 일정시간이 지나게 되면 Application 객체는 자동으로 종료하게 된다.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">Application 객체의 종료후 다시 클라이언트가 접속하면 Application 객체가 다시 가동하게 된다.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">이제 Application 객체가 가지고 있는 기능은 전체적으로 한번 살펴 보도록 하자 .</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><strong>(1) 컬렉션(Collection)</strong></p><p><p><p><p><p><p><p><p><p><p><br /><table cellspacing="1" cellpadding="5" width="540" bgcolor="#666666" border="0"><tbody><tr bgcolor="#c8c8c8"><td width="120"><strong>Collection</strong></td><td width="424"><strong>설명</strong></td></tr><tr bgcolor="#ffffff"><td>Contents</td><td>Application 객체에 의해 관리되는 변수들 가운데 &lt;object&gt;에 의해 정의된 변수를 제외한 모든 변수들에 대한 정보</td></tr><tr bgcolor="#ffffff"><td>StaticObject</td><td>Application 객체에 의해 관리되는 변수들 가운데 &lt;object&gt;에 의해 정의된 모든 변수들에 대한 정보</td></tr></tbody></table><br /></p></p></p></p></p></p></p></p></p></p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><br /><strong>(2) 메소드(Method)</strong></p><p><p><p><p><p><p><p><p><p><p><p><p><p><p><p><p><br /><table cellspacing="1" cellpadding="5" width="540" bgcolor="#666666" border="0"><tbody><tr bgcolor="#c8c8c8"><td width="120"><strong>Method</strong></td><td><strong>설명</strong></td></tr><tr bgcolor="#ffffff"><td>Contents.Remove</td><td>지정한 변수이름을 Application 객체의 Contents 컬렉션에서 삭제한다.</td></tr><tr bgcolor="#ffffff"><td>Contents.RemoveAll</td><td>Application.Contents 컬렉션에 추가된 모든 항목을 삭제한다.</td></tr><tr bgcolor="#ffffff"><td>Lock</td><td>다른 클라이언트가 Application 속성을 수정하지 못하게 한다.</td></tr><tr bgcolor="#ffffff"><td>UnLock</td><td>다른 클라이언트가 Application 속성을 수정할 수 있도록 Lock 속성을 해제한다.</td></tr></tbody></table><br /><br /></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p></p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><strong>(3) 이벤트(Event)</strong></p><p><p><p><p><p><p><p><p><p><p><p><table cellspacing="1" cellpadding="5" width="540" bgcolor="#666666" border="0"><tbody><tr bgcolor="#c8c8c8"><td width="120"><strong>Event</strong></td><td><strong>설명</strong></td></tr><tr bgcolor="#ffffff"><td>Application_OnStart</td><td>Application 객체가 시작될때의 이벤트</td></tr><tr bgcolor="#ffffff"><td>Application_Onend</td><td>Application 객체가 종료될때의 이벤트</td></tr></tbody></table><br /></p></p></p></p></p></p></p></p></p></p></p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><strong><br /><font size="3">2. Application 변수</font></strong></p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">웹서버에 접속하는 모든 사용자들에게 공통으로 적용되는 전역(global)변수를 설정하여 사용한다.</p><p><p><p><p><br /><table cellspacing="1" cellpadding="5" width="540" bgcolor="#666666" border="0"><tbody><tr bgcolor="#c8c8c8"><td width="139"><strong>Application 객체변수</strong></td><td width="378" bgcolor="#ffffff"><strong>Application("변수이름") = 값</strong></td></tr></tbody></table><br /></p></p></p></p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><br />사용예는 다음과 같다.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">Application("strText1") = "1234567890"&nbsp;<br />Application("strText2") = "ABCDEFGHIJ"&nbsp;<br />Application("strText3") = "A1B2C3D4E5"</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">Str1 = Application("strText1") &amp; Application("strText2") ' Str1 = "1234567890ABCDEFGHIJ"</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">Application("strText1")이 하나의 변수 역활을 한다. 이때 사용하는 Application 변수는 웹서버내의 모든 페이지에 영향을 미치는 전역변수로의 역활을 한다.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><strong><font size="3">3. 컬렉션(Cooki colletion)</font></strong></p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><strong>(1) Contents 컬렉션</strong></p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">Application 레벨에서 선언된 모든 객체중 &lt;object&gt;를 사용하지 않고 선언된 객체들을 포함하고 있다. 즉, Application 선언을 통해 만들어진 변수와 Server.Create object로 만들어 Application 객체에 할당된 객체를 모드 포함한다.</p><p><p><p><p><table cellspacing="1" cellpadding="5" width="540" bgcolor="#0066ff" border="0"><tbody><tr><td bgcolor="#ffffff" height="23">Application.Contents( Key)</td></tr></tbody></table><br /><br /></p></p></p></p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">For each 문으로 Application.contents 컬렉션의 모든 아이템에 접근할 수 있다.</p><p><p>[&nbsp;<strong>App_contents.asp</strong>&nbsp;]<br /><br /><br /><table cellspacing="1" cellpadding="5" width="540" bgcolor="#0066ff" border="0"><tbody><tr><td bgcolor="#ffffff"><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">&lt;%&nbsp;<br />Application("strText1") = "1234567890"&nbsp;<br />Application("strText2") = "ABCDEFGHIJ"&nbsp;<br />Application("strText3") = "A1B2C3D4E5"&nbsp;<br />%&gt;</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">&lt;%&nbsp;<br />For Each Key in Application.Contents&nbsp;<br />Response.Write Key + " = " + Application(Key) + "&lt;BR&gt;"&nbsp;<br />Next&nbsp;<br />%&gt;</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">&lt;%&nbsp;<br />For intItem = 1 to Application.Contents.Count&nbsp;<br />Response.Write CStr(intItem) + " = "&nbsp;<br />Response.Write Application.Contents(intItem) + "&lt;BR&gt;"&nbsp;<br />Next&nbsp;<br />%&gt;</p></td></tr></tbody></table><br /><br /></p></p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">실행한 결과 화면이다.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><br /></p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><strong>(2) StaticObjects 컬렉션</strong></p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">StaticObjects 컬렉션 Application 레벨에서 선언된 모든 객체를 포함한다는 면에서는 Contents 컬렉션과 비슷하지만, 다른점은 &lt;object&gt; 태그를 사용해 생성된 객체의 목록들만을 포함한다.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">&lt;object&gt; 태그내의 SCOPE 속성에 Application 속성을 주게 되는데 이경우 Global.asa 파일에서만 선언할 수 있다.</p><p><p><p><br /><table cellspacing="1" cellpadding="5" width="540" bgcolor="#0066ff" border="0"><tbody><tr><td bgcolor="#ffffff" height="23">Application.StaticObjects( Key)</td></tr></tbody></table><br /></p></p></p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><br />사용예를 보도록 하자.</p><p><p><p><br /><table cellspacing="1" cellpadding="5" width="540" bgcolor="#0066ff" border="0"><tbody><tr><td bgcolor="#ffffff" height="23">&lt;%&nbsp;<br />Dim strKey&nbsp;<br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">For Each strKey In Application.StaticObjects&nbsp;<br />Response.Write strKey &amp; " = &lt;i&gt;(object)&lt;/i&gt;&lt;BR&gt;"&nbsp;<br />Next&nbsp;<br />%&gt;</p></td></tr></tbody></table><br /><strong><font size="3">4. 메소드(Method)</font></strong>&nbsp;<br /></p></p></p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><strong>(1) Contents.Remove 메소드</strong></p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">Contents.Remove 메소드는 문자열이나 정수 중 하나를 입력매개변수로 가진다. 입력매개변수가 문자열이면 Contents 컬렉션에서 같은 문자열을 가진 항목을 찾아 제거하고 정수이면 Contents 컬렉션의 시작부분부터 항목의 번호를 세어서 해당항목을 제거한다.</p><p><p><p><br /><table cellspacing="1" cellpadding="5" width="540" bgcolor="#0066ff" border="0"><tbody><tr><td bgcolor="#ffffff" height="23">Application.Contents.Remove( id )</td></tr></tbody></table><br /></p></p></p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><br />사용예를 보자.</p><p><p><p><p><table cellspacing="1" cellpadding="5" width="540" bgcolor="#0066ff" border="0"><tbody><tr><td bgcolor="#ffffff" height="23"><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">&lt;%<br />Application("myapp1")="val1"&nbsp;<br />Application("myapp2")="val2"&nbsp;<br />Application("myapp3")="val3"&nbsp;<br /><br />Application.Contents.Remove("myapp2")<br />%&gt;</p></td></tr></tbody></table><br /><br /></p></p></p></p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><strong>(2) Contents.RemoveAll 메소드</strong></p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">Contents 컬렉션에 있는 모든 항목을 제거한다.</p><p><p><p><p><tr><td bgcolor="#ffffff" height="23">Application.Contents.RemoveAll</td></tr><br /></p></p></p></p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">사용예를 보자.</p><p><p><p><br /><tr><td bgcolor="#ffffff" height="23"><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">&lt;%<br />Application("myapp1")="val1"&nbsp;<br />Application("myapp2")="val2"&nbsp;<br />Application("myapp3")="val3"&nbsp;<br /><br />Application.Contents.RemoveAll<br />%&gt;</p></td></tr><br /></p></p></p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><strong>(3) Lock 메소드</strong></p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">Lock 메소드는 다른 세션의 사용자가 Application 객체에 저장된 변수의 값을 수정하지 못하도록 잠글 수 있는 메소드이다. 즉, 한번에 한명의 사용자만이 Application 변수의 값을 변경하거나 접근 할 수 있다. unlock이 호츨될때까지 잠근다. Unlock 호출되지 않으면 서버는 ASP 파일의 실행이 종료되거나 스크립트의 시간이 초과 되었을 경우에만 잠겨진 Application 객체를 해제한다.</p><br /><br /><br /><br /><table cellspacing="1" cellpadding="5" width="540" bgcolor="#0066ff" border="0"><tbody><tr><td bgcolor="#ffffff" height="23">Application.Lock</td></tr></tbody></table><br /><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><strong>(4) UnLock 메소드</strong></p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">UnLock 메소드는 Lock 메소드로 부터 잠긴 접근권한을 해제한다.</p><br /><br /><br /><br /><table cellspacing="1" cellpadding="5" width="540" bgcolor="#0066ff" border="0"><tbody><tr><td bgcolor="#ffffff" height="23">Application.UnLock</td></tr></tbody></table><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><br />사용예를 보도록 하자.</p>[&nbsp;<strong>Application_lock.asp</strong>&nbsp;]<br /><br /><br /><br /><br /><table cellspacing="1" cellpadding="5" width="540" bgcolor="#0066ff" border="0"><tbody><tr><td bgcolor="#ffffff" height="270">&lt;%@ Language="VBScript" %&gt;<br />&lt;%&nbsp;<br />Response.Write("&lt;br/&gt;Before Remove&lt;br/&gt;")&nbsp;<br />Application.Lock&nbsp;<br />Application.Contents.Item("str1") = ("First thing")&nbsp;<br />Application.Contents("str2") = ("Second thing")&nbsp;<br />Application("str3") = ("Third thing")&nbsp;<br />Application.Unlock&nbsp;<br />For Each Key in Application.Contents&nbsp;<br />&nbsp;&nbsp;Response.Write Key + " = " + Application(Key) + "&lt;br/&gt;"&nbsp;<br />Next&nbsp;<br />Response.Write("&lt;br/&gt;After Remove&lt;br/&gt;")&nbsp;<br />Application.Lock&nbsp;<br />Application.Contents.Remove("str1")&nbsp;<br />Application.Contents.Remove("str2")&nbsp;<br />Application.Unlock&nbsp;<br />For Each Key in Application.Contents&nbsp;<br />&nbsp;&nbsp;Response.Write Key + " = " + Application(Key) + "&lt;br/&gt;"&nbsp;<br />Next&nbsp;<br />%&gt;</td></tr></tbody></table><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><br /><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><strong><font size="3">5. 이벤트(Event)</font></strong></p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><strong>(1) Application_OnStart</strong></p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">이 이벤트는 첫번째 사용자에 의해 웹 애플리케이션 내의 첫번째로 접근되는 페이지가 실행될 때 발생한다. 발생되는 시점은 첫번째 사용자의 session이 생성되기 전에 발생한다.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">일반적으로 처음 사용자가 접속할때 일괄적으로 처리해야 하는 프로세스를 동작하기 위해 적용한다. 자세한 내용은 global.asa 를 다룰 때 언급하겠다.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><strong>(2) Application_OnEnd</strong></p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">이 이벤트는 웹서버가 shotdown 될 때나 또는 ASP Application이 끝날때 즉 마지막 사용자 세션이 끝나 그 세션의 OnEnd 이벤트내의 코드가 실행되었을때 발생한다.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">일반적으로 마지막 사용자의 접속이 끊어 졌을때 일괄적으로 처리해야 하는 프로세스를 동작하기 위해 적용한다. 역시 자세한 내용은 global.asa 를 다룰 때 언급하겠다.</p></td></tr>
