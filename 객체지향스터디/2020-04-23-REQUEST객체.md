><tr><td valign="center"><font color="#cc00ff">▣&nbsp;<font size="4"><strong>Request 객체</strong></font></font></td></tr><br style="color: rgb(0, 0, 0); font-family: Gulim; line-height: 19px; "><tr bgcolor="#ffffff"><td valign="center" width="80" height="39"><br /><div align="center"><strong><font color="#ff3366">§ 학습목표</font></strong></div></td><td valign="center"><strong>&nbsp;&nbsp;1. Request 객체의 기능을 간단히 설명할 수 있다.&nbsp;<br />&nbsp;&nbsp;2. Request 객체의 속성과 메소드를 알고 사용할 수 있다.</strong></td></tr><br style="color: rgb(0, 0, 0); font-family: Gulim; line-height: 19px; "><br style="color: rgb(0, 0, 0); font-family: Gulim; line-height: 19px; "><tr><td valign="top"><p><br /></p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">&nbsp;</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><strong><font size="3">1. Request 객체</font></strong></p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">Request 객체는 Response 객체와는 반대로 클라이언트에서 서버로 전달한 HTTP헤더, 텍스트, HTML, 스크립트등의 정보를 서버에서 받아 들일때 사용하는 객체이다. 즉, 게시판 내용이나 로그인 정보를 사용자가 입력하면 그 내용을 서버에서 받아 들일 때 사용할 수 있는 객체이다.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">일단 Request 객체가 가지고 있는 기능을 전체적으로 한번 살펴 보도록 하자 .</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><strong>(1) 컬렉션(Collection)</strong></p><br /><br /><tr bgcolor="#c8c8c8"><td width="120"><strong>Collection</strong></td><td width="424"><strong>설명</strong></td></tr><tr bgcolor="#ffffff"><td><strong><font color="#ff0000">Form</font></strong></td><td>웹 브라우저에서 서버로 넘어온 Form의 Post 방식의 데이터를 처리한다. (읽기)</td></tr><tr bgcolor="#ffffff"><td><strong><font color="#ff0000">QueryString</font></strong></td><td>웹 브라우저에서 서버로 넘어온 Form의 Get 방식의 데이터와 사용자가 직접 전달한 query 문자열을 다룬다. (읽기)</td></tr><tr bgcolor="#ffffff"><td><strong><font color="#ff0000">ServerVariables</font></strong></td><td>미리 정의되어 있는 환경변수 값 또는 클라이언트에서 전달된 HTTP헤더 값에 대한 정보들을 다룬다. (읽기)</td></tr><tr bgcolor="#ffffff"><td>Cookies</td><td>클라이언트의 웹브라우저와 관련된 쿠키정보를 다룬다. (읽기)</td></tr><tr bgcolor="#ffffff"><td>ClientCertificate</td><td>웹브라우저에 의해 발생된 인증 필드를 검색한다. (읽기)</td></tr><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><br /><strong>(2) 속성(Property)</strong></p><p><p><p><p><p><p><p><br /><tr bgcolor="#c8c8c8"><td width="120"><strong>Property</strong></td><td><strong>설명</strong></td></tr><tr bgcolor="#ffffff"><td height="23">TotalBytes</td><td>클라이언트가 전달한 자료의 전체 바이트수를 저장한다. (읽기)</td></tr><br /><br /></p></p></p></p></p></p></p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><strong>(3) 메소드(Method)</strong></p><p><p><p><p><p><p><p><br /><table cellspacing="1" cellpadding="5" width="540" bgcolor="#666666" border="0"><tbody><tr bgcolor="#c8c8c8"><td width="120"><strong>Method</strong></td><td><strong>설명</strong></td></tr><tr bgcolor="#ffffff"><td>BinaryRead</td><td>클라이언트의 웹브라우저에 전달된 자료를 문자세트 변환없이 표시하는 메소드이다.</td></tr></tbody></table><br /></p></p></p></p></p></p></p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><br />뭐...대충 살펴보니 컬렉션부분이 좀 많고 중요한것 같이 보인다. 맞다. Request 객체는 컬렉션을 집중적으로 봐야 한다.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">머리가 또 아프다. 산넘어 산이다... 진짜 공부 해야만 하나? 이런 ....</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">참자... 그리고 공부해야 한다. 이왕 시작한거 끝장을 봅시다 !!!</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><strong><font size="3">2. 컬렉션(Colletion)</font></strong></p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><strong>(1) Form 컬렉션</strong></p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">Request.Form 컬렉션은&nbsp;<font color="#ff0000">정말 중요한 컬렉션</font>이다. 여러분들이 사용자들로 부터 Form을 이용하여 데이터를 받아 들일때 사용하는 컬렉션이다.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">Request.Form 컬렉션은 HTML 문서의 &lt;Form&nbsp;<font color="#ff0000">Method='POST'</font>&nbsp;...&gt; .... &lt;/Form&gt;으로 정의된 곳에서 사용자가 입력한 자료를 전달 받는 컬렉션인 것이다. 이때 &lt;Form&gt; 태그에 method 옵션값은 반드시 "POST"로 지정되어 있어야 한다.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">다음 예를 살펴보자</p>[&nbsp;<strong>login.asp</strong>&nbsp;]<br /><br /><br /><br /><br /><table cellspacing="1" cellpadding="5" width="540" bgcolor="#0066ff" border="0"><tbody><tr><td bgcolor="#ffffff">&lt;HTML&gt;<br />&lt;HEAD&gt;<br />&lt;TITLE&gt; Form &lt;/TITLE&gt;<br />&lt;/HEAD&gt;&nbsp;<br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">&lt;BODY&gt;<br />&lt;font size="3"&gt;사용자 로그인&lt;/font&gt;&lt;hr size="1"&gt;<br />&lt;Form method="post" name="frm1" Action="loginCheck.asp"&gt;<br />&nbsp;&nbsp;&nbsp;&lt;table&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr &gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;아이디 : &lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;&lt;input type="text" name="userid"&gt; &lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;비밀번호 : &lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;&lt;input type="password" name="userpw"&gt; &lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr height="30"&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td colspan="2" valign="middle" align="center"&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input type="submit" value=" 로그인 "&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br />&lt;/Form&gt;<br />&lt;/BODY&gt;<br />&lt;/HTML&gt;<br /></p></td></tr></tbody></table><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><br />위의 문서는 흔히 볼 수 있는 로그인 화면이다. 아이디와 비밀번호를 입력받기 위한 입력 박스가 있고, 입력한 자료를 서버로 전송하기 위한 버튼이 보일 것이다. 그리고 자세히 보면 아이디와 비밀번호를 입력받는 &lt;input&gt; 태그에 name이 설정되어 있다. 이 name은 각 개체를 구분하는데 사용된다.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">위의 프로그램을 일력하고 실행하면 다음과 같은 화면이 나올 것이다.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; "><br /></p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">이때 사용자가 입력창에 자료를 입력하고 로그인 버튼을 클릭하면 submit기능에 의해 정보가 서버로 전송이 된다. 문제는 이렇게 전송되어 오는 정보를 서버에서 받아야 하는데 이때 이 정보를 받는 작업을 실행할 파일이 필요하다.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">그 파일은 &lt;Form&gt; 태그의 Action 속성에 의해 정해 진다. 이 예제에서는 loginCheck.asp 라는 파일로 처리되고 있다. 즉, login.asp 라는 파일과 같은 폴더내에 loginCheck.asp라는 파일이 존재하고 있어야 하며, 전송버튼을 누르면 자동으로 loginCheck.asp 파일을 호출하여 실행시키며 form에 입력된 정보를 전송하여 준다. 이때 loginCheck.asp 파일의 내용은 전송되어 오는 정보를 받는 작업이 처리되도록 프로그래밍이 되어야 한다.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">일단 다음의 프로그램을 보도록 하자.</p>[&nbsp;<strong>loginCheck.asp</strong>&nbsp;]<br /><br /><br /><br /><br /><table cellspacing="1" cellpadding="5" width="540" bgcolor="#0066ff" border="0"><tbody><tr><td bgcolor="#ffffff">&lt;%<br />id = request.Form("userid")<br />pw = request.Form("userpw")<br />%&gt;<br />입력한 아이디는 &lt;%=id%&gt; 입니다. &lt;br&gt;<br />입력한 비밀번호는 &lt;%=pw%&gt; 입니다. &lt;br&gt;</td></tr></tbody></table><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><br />위 예제 프로그램을 설명하겠다. 일단 login.asp 의 &lt;form&gt;에서 데이터가 전송되어 오는데 이것을 서버측에서 넘겨 받기 위해서는 Request 객체가 필요하다. 그리고 정보 전송방식이 post 방식이라 Form 컬렉션을 이용해야 한다. 그리고 마지막으로 전송되어지는 정보는 두가지이다. 이 두가지를 구분지어 전송 받아야 하는데 구분을 짓는 방법은 &lt;input&gt;에 사용된 name 속성에 지정된 값으로 구분하여 받는다.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">즉, 전송되는 데이터는 &lt;input&gt; 의 name속성값과 시용자가 입력한 데이터가 쌍으로 전송되어 오는 것이다. 데이터를 구분짓기위한 것이 &lt;input&gt; 의 name속성값이니 이것이 바로 컬렉션의 key가 되겠고, 사용자가 입력한 데이터는 data가 될 것이다.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">때문에 정보를 전송받는 형태는 다음과 같이 되는 것이다.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><strong>Request.Form("userid")</strong></p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">login.asp에서 데이터를 전달하는 방법은 "&lt;input&gt; 의 name속성값=값" 형태로 전송되고, 전송되는 값이 2개 이상인 경우는 &amp; 로 구분을 지어 보낸다.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">예로 아이디에 'mydosu' 를, 비밀번호에 "12345" 라는 데이터를 입력하고 전송하면 다음과 같은 데이터가 전송된다.</p><br /><br /><br /><br /><table cellspacing="1" cellpadding="5" width="540" bgcolor="#0066ff" border="0"><tbody><tr><td bgcolor="#ffffff">"userid=mydosu&amp;userpw=12345"</td></tr></tbody></table><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><br />다만 이 정보는 &lt;form&gt;의 Metod 값이<font color="#ff0000">&nbsp;POST인 경우</font>는 전송되어지는 값이 화면에 보여지지 않고 비밀스럽게&nbsp;<font color="#ff0000">이진 데이터로 전송</font>되어진다. 이는<font color="#ff0000">HTTP 헤더에 저장되어 전달</font>되기 때문이다. 아울러 전송되어지는&nbsp;<font color="#ff0000">데이터의 양도 제한이 없다</font>.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">결과를 보도록 하자.</p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; "><br /></p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">만약, &lt;input&gt; 의 name 속성값이 같은 값으로 여러개가 존재한다면 어떻게 구분지을 수 있을까?</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">다음의 예를 보도록 하자.</p><p><p><p><p>[&nbsp;<strong>hobby.asp</strong>&nbsp;]<br /><br /><br /><table cellspacing="1" cellpadding="5" width="540" bgcolor="#0066ff" border="0"><tbody><tr><td bgcolor="#ffffff" height="196">&lt;HTML&gt;<br />&lt;HEAD&gt;<br />&lt;TITLE&gt; Form &lt;/TITLE&gt;<br />&lt;/HEAD&gt;&nbsp;<br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">&lt;BODY&gt;<br />&lt;font size="3"&gt;사용자 취미&lt;/font&gt;&lt;hr size="1"&gt;<br />&lt;Form method="post" name="frm1" Action="hobbyCheck.asp"&gt;<br />&lt;input type="checkbox" name="hobby"&gt;운동&lt;br&gt;<br />&lt;input type="checkbox" name="hobby"&gt;등산&lt;br&gt;<br />&lt;input type="checkbox" name="hobby"&gt;독서&lt;br&gt;<br />&lt;input type="checkbox" name="hobby"&gt;수면&lt;br&gt;&lt;br&gt;<br />&lt;input type="submit" value=" 전 송 "&gt;<br />&lt;/Form&gt;<br />&lt;/BODY&gt;<br />&lt;/HTML&gt;</p></td></tr></tbody></table><br />[&nbsp;<strong>hobbyCheck.asp</strong>&nbsp;]<br /><br /><br /><table cellspacing="1" cellpadding="5" width="540" bgcolor="#0066ff" border="0"><tbody><tr><td bgcolor="#ffffff" height="44">&lt;%<br />hb = request.Form("hobby")<br />%&gt;<br />선택한 취미는 &lt;%=hb%&gt; 입니다. &lt;br&gt;</td></tr></tbody></table><br /></p></p></p></p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">이 예제를 입력해 보고 다음과 같이 실행해 보자.</p><br /><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; "><br /></p><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">3개가 체크되었다는 뜻으로만 on이 3개만 나타난다.</p></td></tr>
